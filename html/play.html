<html>
<head>
<title>Play</title>
<style>

  :root {
    --c-1: #111;
    --c-f: #fff;
    --c-2: #222;
    --c-3: #333;
    --c-4: #444;
    --c-5: #555;
    --c-6: #666;
    --c-8: #888;
    --c-b: #bbb;
    --c-c: #ccc;
    --c-e: #eee;
    --c-f: #fff;
    --c-d: #ddd;
    --c-r: #831;
    --t-b: 0.5;
    --c-o: rgba(34, 34, 34, 0.9);
    --c-tb: rgba(34, 34, 34, var(--t-b));
    --c-tba: rgba(102, 102, 102, var(--t-b));
    --c-tbh: rgba(51, 51, 51, var(--t-b));
    --th: 70px;
    --tp: 70px;
    --bh: 63px;
    --tbp: 14px 14px 10px 14px;
    --bbp: 9px 0 7px 0;
    --bhd: none;
    --bmt: 0px
  }

  html {
    touch-action: manipulation
  }

  body {
    margin: 0;
    background-color: var(--c-1);
    font-family: Helvetica, Verdana, sans-serif;
    font-size: 17px;
    color: var(--c-f);
    text-align: center;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    scrollbar-width: 6px;
    scrollbar-color: var(--c-sb) transparent
  }

  body,
  html {
    height: 100%;
    width: 100%;
    position: fixed;
    overscroll-behavior: none
  }


  .plm {
    display: flex;
    justify-content: center;
  }

  .plm div {
    flex: 300px 0 0;
    border:1px solid #fff;
  }

  ul,
  #ul_playlist {
    padding: 0;
    margin: 0;
    max-width: 500px;
  }

  #ul_playlist {
    background-color: var(--c-3);
  }

  li {
    list-style: none;
    padding: 12px 16px;
    background-color: var(--c-5);
    margin: 2px 0;
    cursor: move;
    border: 2px solid blue;
  }

  li.selected {
    background: rgba(255,0,0,.5);
  }

  input[type=number],
  input[type=text] {
    background: var(--c-3);
    color: var(--c-f);
    border: 0 solid #fff;
    border-radius: 25px;
    padding: 8px;
    margin: 6px 6px 6px 0;
    font-size: 19px;
    transition: background-color .2s;
    outline: 0;
    width: 100px;
  }
  
  ::selection {
    background: var(--c-b)
  }

  input[type=number] {
    text-align: right;
  }

  input[type=text] {
    width: 200px;
    text-align: center
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
    appearance: textfield
  }

  input[type=number]:focus,
  input[type=text]:focus {
    background: var(--c-6)
  }

/*
  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none
  }
*/

  .rmbutton {
    color: var(--c-f);
    background-color: red;
    float: left;
  }

  .btn {
    padding: 8px;
    margin: 10px;
    width: 230px;
    font-size: 19px;
    background-color: var(--c-3);
    color: var(--c-f);
    cursor: pointer;
    border: 0 solid #fff;
    border-radius: 25px;
    transition-duration: .5s;
    -webkit-backface-visibility: hidden;
    -webkit-transform: translate3d(0, 0, 0)
  }

</style>
</head>
<body>

<body>
  <div class="plm">
    <div id="am_btns">
      <h4>Saved Animations</h4>
    </div>
    <div id="pl_btns">
      <h4>Saved Playlists</h4>
    </div>
  </div>

<script>

let base_url = "";
if (window.location.protocol == "file:") {
	// makes for easier debugging.
	// if html is loaded locally, can see the results of editing more easily.
	// otherwise every change to html would require uploading new version to microcontroller.
	base_url = "http://192.168.1.243";
}

async function fetch_source() {

  let am_btns_div = document.getElementById("am_btns");
  let pl_btns_div = document.getElementById("pl_btns");

  const t = await fetch(base_url+"/file_list.json");
  let reply = await t.json();
  console.log(reply)
  
  for (let i = 0; i < reply.length; i++) {
    console.log(i);
    console.log(reply[i]);
    console.log(reply[i]["type"]);
    let type = reply[i]["type"]; 
    let id = reply[i]["path"];
    let name = reply[i]["name"];
    if(type && id && name && type === "file") { 
      if (id.startsWith("/files/am/")) {
        am_btns_div.insertAdjacentHTML("beforeend", `<input type="button" id="${id}" class="btn btn-s btn-i" data-type="am" value="${name}" onclick="load('am', '${id}')">`)
      }
      else if (id.startsWith("/files/pl/")) {
        pl_btns_div.insertAdjacentHTML("beforeend", `<input type="button" id="${id}" class="btn btn-s btn-i" data-type="pl" value="${name}" onclick="load('pl', '${id}')">`)
      }
    }
  }
}


async function load(type, id) {
	const t = await fetch("http://192.168.1.243/load", {
	  method: "POST",
		  headers: {
			  "Content-Type": "application/x-www-form-urlencoded"
			},
			body: `t=${type}&id=${id}`
	}),
  reply = await t.json();
	console.log(reply)
}

window.addEventListener("load", fetch_source);

</script>
</body>
</html>
